<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru">
<head>
	<title>Как асинхронно считывать и записывать данные в файл? - C# - Киберфорум</title>
	<link rel="canonical" href="https://www.cyberforum.ru/csharp-beginners/thread2737473.html" />
	
	<base href="https://www.cyberforum.ru/" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="keywords" content="C#, асинхронность, для начинающего, запись в файл, чтение из файла, Как асинхронно считывать и записывать данные в файл?" />
<meta name="description" content="Как асинхронно считывать и записывать данные в файл? C# Решение и ответ на вопрос 2737473" />

<meta name="viewport" content="width=device-width">

<link rel="stylesheet" type="text/css" href="//cyberstatic.net/clientscript/vbulletin_css/cyberforum.css" />
<link rel="stylesheet" type="text/css" href="//cyberstatic.net/clientscript/vbulletin_important.css" />



<script>
<!--
var SESSIONURL = "s=03b48a9c4be1db5de7e2b040ade9ff6f&";
var SECURITYTOKEN = "guest";
var IMGDIR_MISC = "//cyberstatic.net/images/misc";
var vb_disable_ajax = parseInt("0", 10);
// -->
</script>

<script src="//ajax.googleapis.com/ajax/libs/yui/2.9.0/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/yui/2.9.0/build/connection/connection-min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="//cyberstatic.net/clientscript/custom/jquery.browser.min.js"></script>

<script src="//cyberstatic.net/clientscript/vbulletin_global2.js"></script>


<script src="//cyberstatic.net/clientscript/vbulletin_vbpost.js"></script>

<script src="//cyberstatic.net/clientscript/vbulletin_post_loader.js"></script>


<script src="//cyberstatic.net/clientscript/vbulletin_md5.js"></script>



	<link rel="alternate" type="application/rss+xml" title="Форум программистов и сисадминов Киберфорум RSS Feed" href="https://www.cyberforum.ru/external.php?type=RSS2" />
	
		<link rel="alternate" type="application/rss+xml" title="C# для начинающих - Киберфорум RSS" href="https://www.cyberforum.ru/external.php?type=RSS2&amp;forumids=91" />
	

<link type="application/opensearchdescription+xml" rel="search" href="https://www.cyberforum.ru/opensearch.xml" title="CyberForum.ru" />
<link rel="stylesheet" href="//cyberstatic.net/clientscript/vbulletin_css/geshi.css" type="text/css" media="screen" />
<link rel="stylesheet" type="text/css" href="//cyberstatic.net/clientscript/vbulletin_css/spoiler.css" />
<script>
	var IMGDIR_BUTTON = "//cyberstatic.net/images/buttons";
</script>


<script>window.yaContextCb=window.yaContextCb||[]</script>
<script src="https://yandex.ru/ads/system/context.js" async></script>



	<style type="text/css" id="vbulletin_showthread_css">
	<!--
	
	#links div { white-space: nowrap; }
	#links img { vertical-align: middle; }
	-->
	</style>
</head>
<body onload="">


<div style="min-width: 1100px;  margin: 7px 20px 80px 20px;">


<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">


<div class="vbmenu_popup" id="vbbloglinks_menu" style="display:none;margin-top:3px" align="left">
	<table cellpadding="4" cellspacing="1" border="0">

	<tr>
		<td class="vbmenu_option"><a href="https://www.cyberforum.ru/blogs/recent-entries/">Блоги программистов и сисадминов</a></td>
	</tr>

	</table>
</div>
<table class="tborder" cellpadding="5" cellspacing="1" border="0" width="100%" align="center">
<tr>

	<td class="alt1" width="100%" style="padding-left: 10px">
		<a href="https://www.cyberforum.ru/"  style="display: block; float: left; margin: 5px 25px 10px 0px"><img loading="lazy" decoding="async" border="0" src="//cyberstatic.net/images/cyberforum_logo.png" height="50px" alt="Форум программистов, компьютерный форум, киберфорум" title="Форум программистов, компьютерный форум, киберфорум" /></a>
		<div class="smallfont" style="float: right; margin: 0px 0px 0px 20px;">
			<div class="ya-share2" data-services="vkontakte,odnoklassniki" data-image="//cyberstatic.net/images/cyberforum_logo.png"></div>
		</div>
		
			
				<span class="forumtitle2">C# для начинающих</span>
			
			<div class="smallfont"><a href="https://www.cyberforum.ru/" accesskey="1">Форум программистов и сисадминов Киберфорум</a>
	<span class="navbar"> &gt; <a href="https://www.cyberforum.ru/programming/">Форум программистов</a></span>

	<span class="navbar"> &gt; <a href="https://www.cyberforum.ru/net-framework/">.NET</a></span>

	<span class="navbar"> &gt; <a href="https://www.cyberforum.ru/csharp-net/">C# .NET</a></span>

	<span class="navbar"> &gt; <a href="https://www.cyberforum.ru/csharp-beginners/">C# для начинающих</a></span>
</div>
		
	</td>

	<td class="alt2" style="padding: 0px">
		<table cellpadding="5" cellspacing="3" border="0" width="230px">
		<tr>
			<td class="smallfont" style="white-space: nowrap"><b><a href="https://www.cyberforum.ru/auth.php" class="forumtitle2">Войти</a></b></td>
		</tr>
		<tr>
			<td>
				<b><a href="https://www.cyberforum.ru/register.php">Регистрация</a></b><br/>
				<a href="https://www.cyberforum.ru/login.php?do=lostpw">Восстановить пароль</a>
			</td>
		</tr>
		</table>

	</td>

</tr>
</table>
<div class="tborder" style="padding:1px; border-top-width:0px; margin-bottom: 3px;">
	<table cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
	<tr align="center">
		
		<td class="vbmenu_control"><a href="https://www.cyberforum.ru/announcement.php?a=3">Правила</a></td>

		<td class="vbmenu_control"><a href="https://www.cyberforum.ru/map.php">Карта форума</a></td>

		<td class="vbmenu_control"><a href="https://www.cyberforum.ru/map.php?f=91">Темы раздела</a></td>


		<td class="vbmenu_control"><a id="vbbloglinks" href="https://www.cyberforum.ru/blogs/">Блоги</a><script>vbmenu_register("vbbloglinks");</script></td>
		
			
			
				<td class="vbmenu_control"><a href="https://www.cyberforum.ru/groups/">Социальные группы</a></td>
			
		
		
			
				<td class="vbmenu_control"><a href="https://www.cyberforum.ru/search.php" accesskey="4">Поиск</a></td>
				
				<td class="vbmenu_control"><a href="https://www.cyberforum.ru/search.php?do=getdaily" accesskey="2">Сообщения за день</a></td>
				
			

			
		
		
		<td class="vbmenu_control" width="100%">&nbsp;</td>
		</tr>
	</table>
</div>


<table id="yatopbanner" cellspacing="0" cellpadding="2" border="0" align="center" width="100%" class="tborder" style="margin: 0px 0px 3px 0px;"><tr>
<td width="100%" class="alt1" align="center" valign="middle">

<div id="yandex_rtb_R-A-29317-1"></div>
<script>window.yaContextCb.push(()=>{
  Ya.Context.AdvManager.render({
    renderTo: 'yandex_rtb_R-A-29317-1',
    blockId: 'R-A-29317-1'
  })
})</script>


</td>
</tr></table>








<a name="poststop" id="poststop"></a>

<div style="margin: 0px 0px 3px 0px;"></div>

<table class="tborder" cellpadding="5" cellspacing="1" border="0" width="100%" align="center" style="border-bottom-width:0px">
<tr>
	<td class="tcat" width="100%">
		<div class="smallfont">
		
		&nbsp;
		</div>
	</td>

<td class="vbmenu_control" id="threadrating" nowrap="nowrap">
	
		<span id="threadrating_current">
			Рейтинг&nbsp;<span title="Средняя оценка">4.69</span>/<span title="Всего голосов">13</span>: <img loading="lazy" decoding="async" class="inlineimg" src="//cyberstatic.net/images/rating/rating_5.gif" alt="Рейтинг темы: голосов - 13, средняя оценка - 4.69" border="0" />
		</span>

	
</td>




</tr>
</table>


		</div>
	</div>
</div>





<div id="posts">

	
<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

	<div id="edit15036368" style="padding:0px 0px 3px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post15036368" class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%" align="center">
<tr valign="top">
	<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="3">
            <div>
               
                    
                        <a class="bigusername" href="https://www.cyberforum.ru/members/1686180.html"><span id="tagg_1686180" style="display:none;">@</span>AnTiTeJI</a>
                    
                    
               
            </div>
			
			
			
			
		
			<div class="smallfont" style="margin-top: 2px;">
				
					
					<div><span id="repdisplay_15036368_1686180" title="Репутация пользователя" style="font-weight: bold">0</span> / <span title="Общая оценка (+0, -0)">0</span> / <span title="Лучшие ответы" style="font-weight: bold">0</span></div>
				<div>Регистрация: 11.09.2020</div>
				
				
				<div>Сообщений: 14</div>
				
				
				
<!-- show awards -->

<!-- /show awards -->

				
			</div>
		
	</td>
</tr>
<tr>
	
		<td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px;" height="15px" >
			
		</td>
		<td class="alt2 smallfont" style="font-weight: normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px; text-align: right;"  width="30px" height="15px">


	
	<a href="https://www.cyberforum.ru/post15036368.html" target="_blank" id="postcount15036368" name="1"><b>1</b></a>
	
	
</td>
	
</tr>

<tr valign="top">
		<td class="alt1" colspan="2" id="td_post_15036368" style="padding-top: 3px;" >

		
			<h1 style="color: #3774A4">Как асинхронно считывать и записывать данные в файл?</h1>
			<div class="smallfont shade" style="margin: 10px 0px 0px 30px">26.11.2020, 02:13. <b>Показов</b> 2572. <b>Ответов</b> <a target="_blank" href="https://www.cyberforum.ru/threadposts2737473.html">4</a></div>
			<div class="smallfont shade" style="margin: 5px 0px 0px 30px"><b>Метки</b> <a href="https://www.cyberforum.ru/tags/%D0%B0%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C.html">асинхронность</a>, <a href="https://www.cyberforum.ru/tags/%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%B0%D1%87%D0%B8%D0%BD%D0%B0%D1%8E%D1%89%D0%B5%D0%B3%D0%BE.html">для начинающего</a>, <a href="https://www.cyberforum.ru/tags/%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C%20%D0%B2%20%D1%84%D0%B0%D0%B9%D0%BB.html">запись в файл</a>, <a href="https://www.cyberforum.ru/tags/%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B8%D0%B7%20%D1%84%D0%B0%D0%B9%D0%BB%D0%B0.html">чтение из файла</a> <img loading="lazy" decoding="async" src="//cyberstatic.net/images/misc/11x11progress.gif" id="tag_form_progress" class="inlineimg" style="display:none" alt="" /> (<a href="https://www.cyberforum.ru/tags/">Все метки</a>)</div>
			<hr size="1" style="color: #AAAAAA; margin: 7px 0px 10px 0px" />
		

		

		
			
		

		<div id="post_message_15036368" style="margin: 2px 2px 2px 5px;">


<div style="float: right; margin: 0px 0px 10px 10px">
<a target=_blank rel="nofollow noopener sponsored" href="https://ref.studwork.ru/new-order/?p=459015"><img src="https://h20x37ek96.a.trbcdn.net/widgets/materials/purple/image-1.gif" loading="lazy" alt="Студворк — интернет-сервис помощи студентам"></a>
</div>


			

			Имеется следующий класс, методы Reader и Writer считывают и записывают списки объектов, в методах Write и Read будет описана дополнительная логика для проверки входящих параметров.<br />
<br />
<div style="margin: 5px 10px 5px 30px"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td><div id="115868815" style="height: 441px" class="codeframe"><table><tr class="li1"><td class="ln" style="padding: 0px 10px 0px 5px;"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="de1"><pre class="de1"><span class="kw4">class</span> FileStreamer
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> Write<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path, List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> list<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> write <span class="sy0">=</span> WriterAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>path, list<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> Read<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> read <span class="sy0">=</span> ReaderAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> read<span class="sy0">.</span><span class="me1">Result</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw1">async</span> Task WriterAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path, List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> list<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">using</span> <span class="br0">&#40;</span>FileStream fs <span class="sy0">=</span> <span class="kw3">new</span> FileStream<span class="br0">&#40;</span>path, FileMode<span class="sy0">.</span><span class="me1">OpenOrCreate</span>, FileAccess<span class="sy0">.</span><span class="me1">Write</span>, FileShare<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">await</span> JsonSerializer<span class="sy0">.</span><span class="me1">SerializeAsync</span><span class="br0">&#40;</span>fs, list<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw1">async</span> Task<span class="sy0">&lt;</span>List<span class="sy0">&lt;</span>T<span class="sy0">&gt;&gt;</span> ReaderAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">using</span> <span class="br0">&#40;</span>FileStream fs <span class="sy0">=</span> <span class="kw3">new</span> FileStream<span class="br0">&#40;</span>path, FileMode<span class="sy0">.</span><span class="me1">Open</span>, FileAccess<span class="sy0">.</span><span class="me1">Read</span>, FileShare<span class="sy0">.</span><span class="me1">Read</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw1">await</span> JsonSerializer<span class="sy0">.</span><span class="me1">DeserializeAsync</span><span class="sy0">&lt;</span>List<span class="sy0">&lt;</span>T<span class="sy0">&gt;&gt;</span><span class="br0">&#40;</span>fs<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span></pre></td></tr></table></div></td></tr></tbody></table></div>Допустим я хочу сразу записать и считать данные, но в большинстве случаев вылетает исключение System.AggregateException. Эксперементируя с кодом я понял что поток пытается обратиться к файлу который уже занят другим потоком. Каким образом можно решить данную проблему? Я думаю мне нужно создать очередь потоков, либо блокировать файл пока с ним работает поток.<br />
<div style="margin: 5px 10px 5px 30px"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td><div id="744265053" style="height: 425px" class="codeframe"><table><tr class="li1"><td class="ln" style="padding: 0px 10px 0px 5px;"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp;<span class="kw4">class</span> Program
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">&#40;</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List<span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span> users <span class="sy0">=</span> <span class="kw3">new</span> List<span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">new</span> Users <span class="br0">&#123;</span> Name <span class="sy0">=</span> <span class="st0">&quot;Alex&quot;</span>, Age <span class="sy0">=</span> <span class="nu0">24</span><span class="br0">&#125;</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">new</span> Users <span class="br0">&#123;</span> Name <span class="sy0">=</span> <span class="st0">&quot;Maria&quot;</span>, Age <span class="sy0">=</span> <span class="nu0">21</span><span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">string</span> path <span class="sy0">=</span> <span class="st_h">@&quot;File.json&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileStreamer<span class="sy0">.</span><span class="me1">Save</span><span class="br0">&#40;</span>path, users<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> array <span class="sy0">=</span> FileStreamer<span class="sy0">.</span><span class="me1">Read</span><span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">foreach</span> <span class="br0">&#40;</span>Users user <span class="kw1">in</span> array<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>user<span class="sy0">.</span><span class="me1">Name</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span>&quot;</span> <span class="sy0">+</span> user<span class="sy0">.</span><span class="me1">Age</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console<span class="sy0">.</span><span class="me1">ReadKey</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw4">class</span> Users
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">string</span> Name <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">int</span> Age <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></table></div></td></tr></tbody></table></div>



		</div>


		
		
		
		



	



	<div style="margin-top: 5px">
		<span id="thumbs_box_15036368">
    <span class="post">
        <span>
            
            <span class="thumbs-post-rate" title="Рейтинг сообщения 0">0</span>
            
        </span>
    </span>
</span>
	</div>


		
		
	</td>
</tr>

</table>
<div id="krba_posts_2737473" class="tborder alt1 smallfont" style="margin-top: 3px;"><div class="alt2" style="border-bottom: 1px solid #AAAAAA; padding: 3px 5px 3px 5px; font-weight:bold;"> Лучшие ответы (<span id="krba_answcount_2737473">1</span>)</div><div style="margin: 5px;" class="smallfont"><span id="krba_removepost_15039076" style="padding: 5px; white-space: nowrap; font-weight: bold;"><a style="text-decoration: none;" href="https://www.cyberforum.ru/csharp-beginners/thread2737473.html#post15039076">Сообщение: #15039076</a> </span> </div></div>



<div style="margin: 3px 0px 3px 0px; display: block">
	<table class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%">
		<tr valign="top">
			<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;">
			</td>
			<td class="alt1" align="left">
<div style="width: 600px; height: auto; margin-right: auto;">
   <div id="movie_video"></div>
</div>
<script type="text/javascript" src="https://vak345.com/s.js?v=8d94458a2b7741a172956c4b6a86f3a7" async></script>
			</td>
		</tr>
	</table>
</div>





<div style="margin: 3px 0px 0px 0px">
	<table class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%">
		<tr valign="top">
			<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="2">
				<div class="smallfont" style="margin-top: 2px;">
					<a class="bigusername" href="https://www.cyberforum.ru/members/20461.html">Programming</a>
					<div class="smallfont">Эксперт</div>
					<div><span title="Репутация пользователя"><b>94731</b></span> / <span title="Благодарности за сообщения">64177</span> / <span title="Лучшие ответы"><b>26122</b></span></div>
				<div>Регистрация: 12.04.2006</div>
				<div>Сообщений: 116,782</div>
				</div>
			</td>
		    <td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; padding: 3px 5px 3px 5px;" height="15px">
			26.11.2020, 02:13
		    </td>
		</tr>
		<tr>
			<td class="alt1" align="left">
			<div style="margin: 2px 2px 2px 5px;">
Ответы с готовыми решениями: 
<br />
<p><strong><a target="_blank" href="https://www.cyberforum.ru/visual-cpp/thread147372.html">Как считывать и записывать данные в файл</a></strong><br />Собственно сабж.Как это сделать?В system:: вроде не нашел чего-то связанного с файлами.  
...</p><p><img class="inlineimg" src="//cyberstatic.net/images/misc/tick.png" title="Есть решение (1)" border="0" alt="" /> <strong><a target="_blank" href="https://www.cyberforum.ru/csharp-beginners/thread1409596.html">ExcelDataReader: как записывать и считывать данные в Excel</a></strong><br />Здравствуйте! Собственно, пошарился и на сайте, и в интернете в целом.   
Я не понимаю, как работать...</p><p><strong><a target="_blank" href="https://www.cyberforum.ru/visual-cpp/thread47858.html">Как записывать (считывать) данные в (из) системный буфер обмена?</a></strong><br />Дали задание в котором необходимо производить запись и чтение данных в системный буфер обмена не...</p><p><strong><a target="_blank" href="https://www.cyberforum.ru/visual-cpp/thread445131.html">Как считывать и записывать в тот же файл?</a></strong><br />Вот допустим мне надо сделать следующее:  
просто пробежаться по файлу и поменять все запятые на...</p>

			</div>
			
<span class="thumbs-post-rate" title="Рейтинг сообщения 4">4</span>
			</td>
		</tr>
	</table>
</div>



<div id="cyber_adsc1" style="margin: 3px 0px 0px 0px; display: block">
	<table class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%">
		<tr valign="top">
			<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;">
			</td>
			<td class="alt1" align="left">

<div id="yandex_rtb_R-A-29317-5"></div>
<script>window.yaContextCb.push(()=>{
  Ya.Context.AdvManager.render({
    renderTo: 'yandex_rtb_R-A-29317-5',
    blockId: 'R-A-29317-5'
  })
})</script>

			</td>
		</tr>
	</table>
</div>








	</div>
	
		</div>
	</div>
</div>


	
<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

	<div id="edit15036409" style="padding:0px 0px 3px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post15036409" class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%" align="center">
<tr valign="top">
	<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="3">
            <div>
               
                    
                        <a class="bigusername" href="https://www.cyberforum.ru/members/1542395.html">randok</a>
                    
                    
               
            </div>
			
			
			
			
		
			<div class="smallfont" style="margin-top: 2px;">
				
					
					<div><span id="repdisplay_15036409_1542395" title="Репутация пользователя" style="font-weight: bold">613</span> / <span title="Общая оценка (+393, -0)">393</span> / <span title="Лучшие ответы" style="font-weight: bold">187</span></div>
				<div>Регистрация: 28.11.2019</div>
				
				
				<div>Сообщений: 852</div>
				
				
				
<!-- show awards -->

<!-- /show awards -->

				
			</div>
		
	</td>
</tr>
<tr>
	
		<td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px;" height="15px" >
			
				26.11.2020, 03:25
				
				
				
			
		</td>
		<td class="alt2 smallfont" style="font-weight: normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px; text-align: right;"  width="30px" height="15px">


	
	<a href="https://www.cyberforum.ru/post15036409.html" target="_blank" id="postcount15036409" name="2"><b>2</b></a>
	
	
</td>
	
</tr>

<tr valign="top">
		<td class="alt1" colspan="2" id="td_post_15036409" style="padding-top: 3px;" >

		

		

		
			
		

		<div id="post_message_15036409" style="margin: 2px 2px 2px 5px;">



			

			Нужно блочить доступ к файлу. Почитайте про синхронизацию потоков <a rel="nofollow noopener noreferrer" href="https://metanit.com/sharp/tutorial/11.4.php" target="_blank" title="https://metanit.com/sharp/tutorial/11.4.php">https://metanit.com/sharp/tutorial/11.4.php</a>.



		</div>


		
		
		
		





	<div style="margin-top: 5px">
		<span id="thumbs_box_15036409">
    <span class="post">
        <span>
            
            <span class="thumbs-post-rate" title="Рейтинг сообщения 0">0</span>
            
        </span>
    </span>
</span>
	</div>


		
		
	</td>
</tr>

</table>

















	</div>
	
		</div>
	</div>
</div>


	
<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

	<div id="edit15036746" style="padding:0px 0px 3px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post15036746" class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%" align="center">
<tr valign="top">
	<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="3">
            <div>
               
                    
                        <a class="bigusername" href="https://www.cyberforum.ru/members/1686180.html"><span id="tagg_1686180" style="display:none;">@</span>AnTiTeJI</a>
                    
                    
               
            </div>
			
			
			
			
		
			<div class="smallfont" style="margin-top: 2px;">
				
					
					<div><span id="repdisplay_15036746_1686180" title="Репутация пользователя" style="font-weight: bold">0</span> / <span title="Общая оценка (+0, -0)">0</span> / <span title="Лучшие ответы" style="font-weight: bold">0</span></div>
				<div>Регистрация: 11.09.2020</div>
				
				
				<div>Сообщений: 14</div>
				
				
				
<!-- show awards -->

<!-- /show awards -->

				
			</div>
		
	</td>
</tr>
<tr>
	
		<td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px;" height="15px" >
			
				26.11.2020, 09:42
				
				&nbsp;<b>[ТС]</b>
				
			
		</td>
		<td class="alt2 smallfont" style="font-weight: normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px; text-align: right;"  width="30px" height="15px">


	
	<a href="https://www.cyberforum.ru/post15036746.html" target="_blank" id="postcount15036746" name="3"><b>3</b></a>
	
	
</td>
	
</tr>

<tr valign="top">
		<td class="alt1" colspan="2" id="td_post_15036746" style="padding-top: 3px;" >

		

		

		
			
		

		<div id="post_message_15036746" style="margin: 2px 2px 2px 5px;">



			

			Вы можете привести пример который будет уместный в этом коде?



		</div>


		
		
		
		





	<div style="margin-top: 5px">
		<span id="thumbs_box_15036746">
    <span class="post">
        <span>
            
            <span class="thumbs-post-rate" title="Рейтинг сообщения 0">0</span>
            
        </span>
    </span>
</span>
	</div>


		
		
	</td>
</tr>

</table>

















	</div>
	
		</div>
	</div>
</div>


	
<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

	<div id="edit15039076" style="padding:0px 0px 3px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post15039076" class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%" align="center">
<tr valign="top">
	<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="3">
            <div>
               
                    
                        <a class="bigusername" href="https://www.cyberforum.ru/members/1542395.html">randok</a>
                    
                    
               
            </div>
			
			
			
			
		
			<div class="smallfont" style="margin-top: 2px;">
				
					
					<div><span id="repdisplay_15039076_1542395" title="Репутация пользователя" style="font-weight: bold">613</span> / <span title="Общая оценка (+393, -0)">393</span> / <span title="Лучшие ответы" style="font-weight: bold">187</span></div>
				<div>Регистрация: 28.11.2019</div>
				
				
				<div>Сообщений: 852</div>
				
				
				
<!-- show awards -->

<!-- /show awards -->

				
			</div>
		
	</td>
</tr>
<tr>
	
		<td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px;" height="15px" >
			
				26.11.2020, 20:25
				
				
				
			
		</td>
		<td class="alt2 smallfont" style="font-weight: normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px; text-align: right;"  width="30px" height="15px">


	
	<a href="https://www.cyberforum.ru/post15039076.html" target="_blank" id="postcount15039076" name="4"><b>4</b></a>
	
	
</td>
	
</tr>

<tr valign="top">
		<td class="alt1" colspan="2" id="td_post_15039076" style="padding-top: 3px;" >

		

		

		
			<div class="smallfont" style="background-color: #cde6ee; border: 1px solid #0B57A5; margin: 0px 0px 15px 0px; padding: 2px 5px 7px; color: #000;">
				<img loading="lazy" decoding="async" src="//cyberstatic.net/images/misc/tick.png" alt="Лучший ответ" /> <b>Сообщение было отмечено AnTiTeJI как решение</b>
			</div>
			<h2>Решение</h2>
		

		<div id="post_message_15039076" style="margin: 2px 2px 2px 5px;">



			

			<b>AnTiTeJI</b>, ну, во-первых, так у вас ничего в файл не запишется, так как все закончится в методе Write на присваивании переменной. И методов наплодили, из одного в другой перекидываете список. Если оставить в текущем варианте, то можно сделать через AutoResetEvent, обычный lock не подойдет, так как там await. Ну и код поправить:<br />
<div style="margin: 5px 10px 5px 30px"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td><div id="376759495" style="height: 281px" class="codeframe"><table><tr class="li1"><td class="ln" style="padding: 0px 10px 0px 5px;"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">static</span> AutoResetEvent handler <span class="sy0">=</span> <span class="kw3">new</span> AutoResetEvent<span class="br0">&#40;</span><span class="kw1">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List<span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span> users <span class="sy0">=</span> <span class="kw3">new</span> List<span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">new</span> Users <span class="br0">&#123;</span> Name <span class="sy0">=</span> <span class="st0">&quot;Alex&quot;</span>, Age <span class="sy0">=</span> <span class="nu0">24</span><span class="br0">&#125;</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">new</span> Users <span class="br0">&#123;</span> Name <span class="sy0">=</span> <span class="st0">&quot;Maria&quot;</span>, Age <span class="sy0">=</span> <span class="nu0">21</span><span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">string</span> path <span class="sy0">=</span> <span class="st_h">@&quot;File.json&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileStreamer<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#40;</span>path, users<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> array <span class="sy0">=</span> FileStreamer<span class="sy0">.</span><span class="me1">Read</span><span class="sy0">&lt;</span>Users<span class="sy0">&gt;</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">foreach</span> <span class="br0">&#40;</span>Users user <span class="kw1">in</span> array<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>user<span class="sy0">.</span><span class="me1">Name</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span>&quot;</span> <span class="sy0">+</span> user<span class="sy0">.</span><span class="me1">Age</span> <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span></pre></td></tr></table></div></td></tr></tbody></table></div><div style="margin: 5px 10px 20px 30px"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td><div id="797284886" style="height: 505px" class="codeframe"><table><tr class="li1"><td class="ln" style="padding: 0px 10px 0px 5px;"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">class</span> FileStreamer
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw1">async</span> <span class="kw4">void</span> Write<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path, List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> list<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">await</span> WriterAsync<span class="br0">&#40;</span>path, list<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> Read<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> read <span class="sy0">=</span> ReaderAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> read<span class="sy0">.</span><span class="me1">Result</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw1">async</span> Task WriterAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path, List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> list<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handler<span class="sy0">.</span><span class="me1">WaitOne</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">using</span> <span class="br0">&#40;</span>FileStream fs <span class="sy0">=</span> <span class="kw3">new</span> FileStream<span class="br0">&#40;</span>path, FileMode<span class="sy0">.</span><span class="me1">OpenOrCreate</span>, FileAccess<span class="sy0">.</span><span class="me1">Write</span>, FileShare<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">await</span> JsonSerializer<span class="sy0">.</span><span class="me1">SerializeAsync</span><span class="br0">&#40;</span>fs, list<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handler<span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw1">async</span> Task<span class="sy0">&lt;</span>List<span class="sy0">&lt;</span>T<span class="sy0">&gt;&gt;</span> ReaderAsync<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> path<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> result<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handler<span class="sy0">.</span><span class="me1">WaitOne</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">using</span> <span class="br0">&#40;</span>FileStream fs <span class="sy0">=</span> <span class="kw3">new</span> FileStream<span class="br0">&#40;</span>path, FileMode<span class="sy0">.</span><span class="me1">Open</span>, FileAccess<span class="sy0">.</span><span class="me1">Read</span>, FileShare<span class="sy0">.</span><span class="me1">Read</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result <span class="sy0">=</span> <span class="kw1">await</span> JsonSerializer<span class="sy0">.</span><span class="me1">DeserializeAsync</span><span class="sy0">&lt;</span>List<span class="sy0">&lt;</span>T<span class="sy0">&gt;&gt;</span><span class="br0">&#40;</span>fs<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handler<span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> result<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span></pre></td></tr></table></div></td></tr></tbody></table></div>Но я бы от кучи методов, футболящих туда-сюда несчастный список, избавился бы.



		</div>


		
		
		
		





	<div style="margin-top: 5px">
		<span id="thumbs_box_15039076">
    <span class="post">
        <span>
            
            <span class="thumbs-post-rate" title="Рейтинг сообщения 1">1</span>
            
        </span>
    </span>
</span>
	</div>


		
		
	</td>
</tr>

</table>

















	</div>
	
		</div>
	</div>
</div>


	
<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

	<div id="edit15039194" style="padding:0px 0px 3px 0px">
	



<table id="post15039194" class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%" align="center">
<tr valign="top">
	<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="3">
            <div>
               
                    
                        <a class="bigusername" href="https://www.cyberforum.ru/members/1686180.html"><span id="tagg_1686180" style="display:none;">@</span>AnTiTeJI</a>
                    
                    
               
            </div>
			
			
			
			
		
			<div class="smallfont" style="margin-top: 2px;">
				
					
					<div><span id="repdisplay_15039194_1686180" title="Репутация пользователя" style="font-weight: bold">0</span> / <span title="Общая оценка (+0, -0)">0</span> / <span title="Лучшие ответы" style="font-weight: bold">0</span></div>
				<div>Регистрация: 11.09.2020</div>
				
				
				<div>Сообщений: 14</div>
				
				
				
<!-- show awards -->

<!-- /show awards -->

				
			</div>
		
	</td>
</tr>
<tr>
	
		<td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px;" height="15px" >
			
				26.11.2020, 20:56
				
				&nbsp;<b>[ТС]</b>
				
			
		</td>
		<td class="alt2 smallfont" style="font-weight: normal; border-bottom: 1px solid #AAAAAA; border-right: 0px; padding: 3px 5px 3px 5px; text-align: right;"  width="30px" height="15px">


	
	<a href="https://www.cyberforum.ru/post15039194.html" target="_blank" id="postcount15039194" name="5"><b>5</b></a>
	
	
</td>
	
</tr>

<tr valign="top">
		<td class="alt1" colspan="2" id="td_post_15039194" style="padding-top: 3px;" >

		

		

		
			
		

		<div id="post_message_15039194" style="margin: 2px 2px 2px 5px;">



			

			Метод Write выполнялся и записывал файл, если после вызова Write прописать Thread.Sleep(5000) то проблема решалась, но это не самое лучшее решение. Я хочу автоматизировать некоторые действия и поэтому описываю Read и Write которые будут иметь перегрузки для моих целей, я понимаю что структура не самая хорошая но мне кажется легче вызвать Writer и Reader чем писать весь его код заново.



		</div>


		
		
		
		





	<div style="margin-top: 5px">
		<span id="thumbs_box_15039194">
    <span class="post">
        <span>
            
            <span class="thumbs-post-rate" title="Рейтинг сообщения 0">0</span>
            
        </span>
    </span>
</span>
	</div>


		
		
	</td>
</tr>

</table>














<div style="margin: 3px 0px 0px 0px">
	<table class="tborder" cellpadding="5" cellspacing="0" border="0" width="100%">
		<tr valign="top">
			<td class="alt2" width="170px" style="border-right: 1px solid #AAAAAA;" rowspan="2">
				<div class="smallfont" style="margin-top: 2px;">
					<a class="bigusername" href="https://www.cyberforum.ru/members/22622.html">IT_Exp</a>
					<div class="smallfont">Эксперт</div>
					<div><span title="Репутация пользователя"><b>87844</b></span> / <span title="Благодарности за сообщения">49110</span> / <span title="Лучшие ответы"><b>22898</b></span></div>
				<div>Регистрация: 17.06.2006</div>
				<div>Сообщений: 92,604</div>
				</div>
			</td>
		    <td class="alt2 smallfont" style="font-weight:normal; border-bottom: 1px solid #AAAAAA; padding: 3px 5px 3px 5px;" height="15px">
			26.11.2020, 20:56
		    </td>
		</tr>
		<tr>
		    <td class="alt1" align="left">
			<div style="margin: 2px 2px 2px 5px;">

<b>Помогаю со студенческими работами <a rel="nofollow noopener sponsored" target="_blank" href="https://www.cyberforum.ru/edu_order.php">здесь</a></b>

<p><a target="_blank" href="https://www.cyberforum.ru/java-j2se/thread514023.html">Как считывать строки из текстового файла и записывать их в файл?</a><br />До этого на java не программил, но щас потребовалось сделать это именно на этом языке. Желательно...</p><p><a target="_blank" href="https://www.cyberforum.ru/csharp-beginners/thread1830895.html">Как считывать и как записывать XML файлы? И вообще,является ли хорошим тоном хранить данные в xml?</a><br />Я знаю,насколько часто меня любят отправлять в гугл,но проблема такова,что везде показывается...</p><p><img class="inlineimg" src="//cyberstatic.net/images/misc/tick.png" title="Есть решение (1)" border="0" alt="" /> <a target="_blank" href="https://www.cyberforum.ru/cpp-beginners/thread768251.html">Сведения о машине можно считывать/записывать в файл</a><br />Помогите пожалуйста, программа выполняет два действия.   
Если 1 - в файл записывается марка машины,...</p><p><a target="_blank" href="https://www.cyberforum.ru/cpp-beginners/thread1794907.html">Fstream не может и записывать в файл, и считывать из него?</a><br />fstream file(&amp;quot;as.txt&amp;quot;);  
int number = 7;  
file &amp;lt;&amp;lt; number;  
int numb;  
file &amp;gt;&amp;gt; numb;  
cout &amp;lt;&amp;lt; numb...</p><p><a target="_blank" href="https://www.cyberforum.ru/csharp-beginners/thread1226365.html">Считывать из файла по 512 байт и записывать их в новый файл</a><br />Надо считывать из файла по 512 байт и записывать их в новый файл.  
Так как я написал, при...</p><p><a target="_blank" href="https://www.cyberforum.ru/cpp-builder/thread383004.html">Нужно переделать, чтобы программа могла считывать данные с файла и записывать в него результат.</a><br />Вот программа, созданная мною в C++ Builder. Она в не квадратной матрице элементы(кроме граничных)...</p>


<br />
<a target="_blank" href="https://www.cyberforum.ru/search.php?do=process&amp;q=Как асинхронно считывать и записывать данные в файл?&amp;forumchoice[]=91&amp;childforums=1&amp;replyless=0&amp;replylimit=1&amp;nocache=0">Искать еще темы с ответами</a>
<br /><br />
Или воспользуйтесь поиском по форуму:
<table width="700px"><tr><td>
<div class="ya-site-form ya-site-form_inited_no" onclick="return {'action':'https://www.cyberforum.ru/yandex.php','arrow':false,'bg':'transparent','fontsize':13,'fg':'#000000','language':'ru','logo':'rb','publicname':'Yandex Site Search #364949','suggest':true,'target':'_blank','tld':'ru','type':2,'usebigdictionary':true,'searchid':364949,'webopt':false,'websearch':false,'input_fg':'#000000','input_bg':'#ffffff','input_fontStyle':'normal','input_fontWeight':'normal','input_placeholder':null,'input_placeholderColor':'#000000','input_borderColor':'#7f9db9'}"><form action="https://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="364949"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script>(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
</td></tr></table>

			</div>
			
<span class="thumbs-post-rate" title="Рейтинг сообщения 5">5</span>
			</td>
		</tr>
	</table>
</div>




	</div>
	
		</div>
	</div>
</div>

<div id="lastpost"></div>
</div>


<div>
	<div class="page" style="text-align: left;">
		<div style="margin: 0px 3px 0px 3px" align="left">

<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="top">
	
		<td>
			<table class="smallfont" width="240px" cellspacing="0" cellpadding="0" border="0"><tr>
				<td>
					<a target="_blank" href="https://www.cyberforum.ru/newreply.php?do=newreply&amp;noquote=1&amp;p=15039194"><img loading="lazy" decoding="async" class="buttonimg" src="//cyberstatic.net/images/buttons/reply.png" alt="Ответ" border="0" /></a>
				</td>
				<td>
					<a target="_blank" href="https://www.cyberforum.ru/newthread.php?do=newthread&amp;f=91"><img loading="lazy" decoding="async" class="buttonimg" src="//cyberstatic.net/images/buttons/newthread.png" alt="Создать тему" border="0" /></a>
				</td>
			</tr></table>
		</td>
	
	
	
</tr>
</table>

















<table class="tborder" cellpadding="5" cellspacing="1" border="0" width="100%" align="center" style="border-top-width:0px">
<tr>
	<td class="thead" colspan="2">Опции темы<a name="goto_threadtools"></a></td>
	
</tr>
<tr valign="top">
	<td class="alt1" colspan="2">
	<div class="smallfont">
		
		
		
	</div>
	</td>
	
</tr>

</table>
<br />

<table cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
<tr valign="bottom">
	<td width="100%" valign="top">
		
	</td>
	<td class="smallfont" align="right">
		
	</td>
</tr>
</table>

<table cellspacing="0" cellpadding="2" border="0" align="center" width="100%" class="tborder" style="margin: 3px 0px 3px 0px;"><tr>
<td width="100%" class="alt1" align="center" valign="middle">

<div id="yandex_rtb_R-A-29317-4"></div>
<script>window.yaContextCb.push(()=>{
  Ya.Context.AdvManager.render({
    renderTo: 'yandex_rtb_R-A-29317-4',
    blockId: 'R-A-29317-4'
  })
})</script>

</td>
</tr></table>


		</div>
	</div>
</div>

<div style="margin: 5px 3px 0px 3px">
<form action="https://www.cyberforum.ru/index.php" method="get" style="clear:left">
<table cellpadding="5" cellspacing="0" border="0" class="tborder" align="center" style="width: 100%;">
<tr>
	
	
		<td class="tfoot">
			<span class="smallfont">КиберФорум - форум программистов, компьютерный форум, программирование</span>
		</td>
	<td class="tfoot" align="right" colspan="2">
		<div class="smallfont">
			<strong>
				<a href="https://www.cyberforum.ru/donate.php">Поддержать</a> -
				
				<a href="https://www.cyberforum.ru/advert.php">Реклама</a> -
				
				
				
				
				
				
				
				<a href="https://www.cyberforum.ru/sendmessage.php" accesskey="9">Обратная связь</a>
			</strong>
		</div>
	</td>
</tr>
</table>
<table cellpadding="5" cellspacing="0" border="0" class="tborder" align="center" style="width: 100%;">
<tr class="alt1" align="right">
	<td align="left" class="smallfont">
		Powered by vBulletin<br />Copyright &copy;2000 - 2023, CyberForum.ru
	</td>
	<td align="right">
<img id="licnt3981" width="88" height="31" style="border:0" 
title="LiveInternet: number of pageviews for 24 hours, of visitors for 24 hours and for today is shown"
src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP/yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"
alt=""/><script>(function(d,s){d.getElementById("licnt3981").src=
"//counter.yadro.ru/hit?t12.2;r"+escape(d.referrer)+
((typeof(s)=="undefined")?"":";s"+s.width+"*"+s.height+"*"+
(s.colorDepth?s.colorDepth:s.pixelDepth))+";u"+escape(d.URL)+
";h"+escape(d.title.substring(0,150))+";"+Math.random()})
(document,screen)</script>


	</td>
</tr>
</table>
</form>




<script type="text/javascript" src="https://ishowyoufuture.com/services/geo.php"></script>
<script type='text/javascript' data-cfasync='false'>
  let e4b7d1b727_cnt = 0;
  let e4b7d1b727_interval = setInterval(function(){
    if (typeof country !== 'undefined') {
        clearInterval(e4b7d1b727_interval);
        let usDomain_e4b7d1b727 = (country === 'UA') ? 'ishowyoufuture.com' :'scatrouting.com';
  
    (function(){
    var ud;
    try { ud = localStorage.getItem('e4b7d1b727_uid'); } catch (e) { }
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.charset = 'utf-8';
    script.async = 'true';
    script.src = 'https://' + usDomain_e4b7d1b727 + '/bens/vinos.js?23402&u=' + ud + '&a=' + Math.random();
    document.body.appendChild(script);
    })();
  } else {
        e4b7d1b727_cnt += 1;
        if (e4b7d1b727_cnt >= 60) {
            clearInterval(e4b7d1b727_interval);
        }
    }
}, 500);
</script>





<script src='https://ru.viadata.store/tag/load.js?sid=104300' defer  charset='UTF-8' ></script>


</div>

<script>
var krtsts = {
   "bburl": "https://www.cyberforum.ru"
};
</script>
<script async src="//cyberstatic.net/clientscript/kr_scripts/tests/addedit.js"></script>
<script async src="//cyberstatic.net/clientscript/kr_scripts/bestanswer/bestanswer.js"></script>
<script>
      var krba_options = {
          img_is_answer: '//cyberstatic.net/images/buttons/is_answer.png',
          img_is_not_answer: '//cyberstatic.net/images/buttons/is_not_answer.png'
      },
      KRBA = new AJAX_KRBA(krba_options);
</script>

<link rel="stylesheet" type="text/css" href="//cyberstatic.net/clientscript/kr_scripts/thumbsup/thumbs.css" />
<script>
var krthumbs = {
  confirm_delete_pos: 'Вы действительно хотите удалить все положительные оценки?',
  confirm_delete_neg: 'Вы действительно хотите удалить все отрицательные оценки?'
}
</script>
<script async src="//cyberstatic.net/clientscript/kr_scripts/thumbsup/thumbsup.js"></script>

<script>
var krtsts = new krtsts_ctrl();
</script>

<style type="text/css">
	span.sortarrow {position:absolute;}
	span.sortarrow img {border:0;}
	a.sortheader {text-decoration:none; display:block; width:100%;}
</style>

<script async src="//cyberstatic.net/clientscript/vbulletin_autosave.js"></script>
<script async src="//cyberstatic.net/clientscript/custom/CtrlPagenav.js"></script>
<script async src="//cyberstatic.net/clientscript/custom/spoiler.js"></script>
<script async src="//cyberstatic.net/clientscript/custom/topbutton.js"></script>
<script async src="//cyberstatic.net/clientscript/sorttable.js"></script>

<script async src="//cyberstatic.net/clientscript/custom/selectcode.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-595018-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-595018-2');
</script>

<script type="text/javascript" > (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(50312308, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/50312308" style="position:absolute; left:-9999px;" alt="" /></div></noscript>


<script async>
<!--
	// Main vBulletin Javascript Initialization
	vBulletin_init();
//-->
</script>

<div id="top-link">
	<span id="topicon" title="Наверх"></span><span id="toptext">Наверх</span>
</div>

<script async src="//yastatic.net/share2/share.js"></script>
</div>


<script type="text/javascript">
//<![CDATA[

window.orig_onload = window.onload;
window.onload = function() {
var cpost=document.location.hash.substring(1);var cpost2='';if(cpost){ var ispost=cpost.substring(0,4)=='post';
					if(ispost)cpost2='post_'+cpost.substring(4);if((cobj = fetch_object(cpost))||(cobj = fetch_object(cpost2))){cobj.scrollIntoView(true);}
					else if(ispost){cpostno = cpost.substring(4,cpost.length);if(parseInt(cpostno)>0){location.replace('https://www.cyberforum.ru/showthread.php?p='+cpostno);};} }

if(typeof window.orig_onload == "function") window.orig_onload();
}

//]]>
</script>
</body>
</html>
